<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title> Teuber-WebAPI </title>
    <link rel="shortcut icon" type="image/png" href="assets/img/ico.ico" style="">
    <script src="assets/js/jquery-3.6.0.min.js"></script>

    <link rel="stylesheet" media="not screen and ( min-width:0px)" href="assets/css/mobile.css">
    <link rel="stylesheet" media="screen and ( min-width:910px)" href="assets/css/web.css">
</head>
<body>
    
    <main>
        <div class="j3" style="background-color: #F0F0F0; padding-bottom: 30px; margin:auto; ">

            <style>
                body{
                    padding:0px;
                }
                label {
                    color: #1B5071;
                }
                input {
                    border: solid #C2C3C9 1.5px;
                    border-radius:5px;
                }
                #log , textarea {
                    border: solid #C2C3C9 1.5px;
                    border-radius: 10px;
                }
                button {
                    border: solid #1A5070 1.5px;
                    border-radius: 5px;
                    outline: none;
                    color: white;
                    background-color: #1A5070;
                    cursor:pointer;
                    padding:5px;
                }
                    button:hover {
                        border: solid #1A5070 1.5px;
                        color: #1A5070;
                        background-color: white;
                    } 
            </style>
            <div class="j1" style="margin: auto; padding: 10px; color: white; padding-top: 30px; padding-bottom: 15px; font-size: 25px; font-weight: 800; background-image: linear-gradient(to right, #184E6F, #E9F1F6); ">
                <div style="padding-left:10px;">
                    TEUBER WEB-API
                </div>
                <div style="font-size:14px; padding-left:10px; text-align:right;">
                    By <a href="https://teuber-hs.vercel.app/" style="color: #184E6F;">Thubakgale MS</a>
                </div>
            </div>
            <div class="j1" style=" margin: auto; padding:10px; background-image: linear-gradient(to right, #184E6F, #E9F1F6); ">

                <div style=" padding: 10px; border-radius: 10px; border: solid #EB4343 1.5px; background-color:white;">
                    <div class="j2" >
                        <div style="flex:1;">
                            <div style="flex:1;">

                                <label style="font-weight: bold; color: #EB4343;">Client</label>
                                <input id="client" value="Sam" type="text" style="margin-left:5px;" /><br /><br />

                                <label style="font-weight: bold;">Url</label>
                                <input id="url0" value='https://bsite.net/teuberwebapi' type="text" style="margin-left:50px;" /><br /><br />

                                <label style="font-weight: bold;">Controller</label>
                                <input id="control" readonly value="Model" type="text" style="margin-left:5px;" /><br /><br />

                                <label style="font-weight: bold;">Function</label>
                                <select id="func" onchange="selc(this)" style="margin-left:15px;">
                                    <option>   Create       </option>
                                    <option>   Update       </option>
                                    <option>   Read         </option>
                                    <option>   Delete       </option>
                                    <option>   Delete All   </option>
                                </select><br /><br />


                            </div>
                            <label style="font-weight: bold;">Parameter</label>
                            <div style="margin-left: 5px; width: 100%; "> 
                                <div class="j2" style="width:100%; margin-top:10px;">
                                    <div style="flex:1; text-align:center; padding-bottom:10px; padding-top:5px;">
                                        <div style="color: orangered; font-weight: 600;"> Idx </div>
                                        <input value="0" id="idx" type="text" style="width:90%; text-align:center;" />
                                    </div>
                                    <div style="flex: 1; text-align: center; padding-bottom: 10px; padding-top: 5px;">
                                        <div style="color: orangered; font-weight: 600;"> First Name </div>
                                        <input value="Sam" id="fn" type="text" style="width:90%; text-align:center;" />
                                    </div>
                                    <div style="flex: 1; text-align: center; padding-bottom: 10px; padding-top: 5px;">
                                        <div style="color: orangered; font-weight: 600;"> Last Name </div>
                                        <input value="Thuba" id="ln" type="text" style="width:90%; text-align:center;" />
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div>
                            <span id="typ" style="font-weight: bold; color: #205474;"> POST </span><br /><br />
                            <button onclick="submit()" style="margin:auto;"> Submit </button>
                        </div>
                    </div>
                    <div class="j2" style="width:100%; padding-top:10px;">
                        <div style="font-weight: bold; color: #EB4343;">URL Request :</div>
                        <div style="flex:1; padding-left:10px; min-height:60px; "> 
                            <textarea readonly="readonly" id="url1" rows="4" style="width:100%; border:none; outline:none;"></textarea><br />
                        </div>
                    </div>
                    <div style="font-weight: bold; color: #EB4343;">
                        <br /> Result : <br />
                        <textarea id="res" readonly="readonly" style="margin: 10px; margin-left:0px; width:100%; min-height:40vh;"></textarea>
                    </div>
                    <div style="font-weight:bold;">
                        <div style="display: flex; padding-top: 10px; border-top: solid #184E6F 2px;">
                            <div style="color: #EB4343;">
                                Log :
                            </div>
                            <div style="flex:1;"></div>
                            <div>
                                <button id="str" style="margin-right:15px;" onclick="start();"> Start </button>
                            </div>
                            <div>
                                <button id="ref" style="margin-right:15px; display:none;" start="false" onclick="refresh()"> Refresh </button>
                            </div>
                            <div>
                                <button id="stp" style="display:none;" onclick="stop();"> Stop </button>
                            </div>
                        </div>
                        <style>
                            .lgh {
                                display: none;
                            }

                            .lgs {
                                display: flex;
                                padding: 5px;
                            }

                            .lgc {
                                flex: 1;
                                text-align: center;
                                color: #1A4F70;
                                font-size: 13px;
                            }

                            .lgc2 {
                                color: #EB4343;
                            }
                        </style>
                        <div id="log" style="margin: 10px; margin-left:0px; width:100%;  height:40vh; overflow-y:scroll;">
                            <div id="lg0" class="lgh">
                                <div class="lgc lgc1">
                                    ESP8266 Thubakgale MS
                                </div>
                                <div class="lgc lgc2">
                                    Correct Execution
                                </div>
                                <div class="lgc lgc3">
                                    4/6/2022 3:45
                                </div>
                            </div>
                        </div>
                    </div>

                    <script>
                        function selc(par) {
                            var a = $(par).val();

                            if (a.trim() == "Read") {
                                $("#typ").html("GET");
                            }
                            else {
                                $("#typ").html("POST");
                            }
                            $("#url1").val("");
                        }
                        function submit() {
                            $("#res").val("");
                            var inp = {
                                "control": $("#control").val() + 'Controller',
                                "func": sel($("#func").val()),
                                "param": JSON.stringify({
                                    "Idx": $("#idx").val(),
                                    "FName": $("#fn").val(),
                                    "LName": $("#ln").val(),
                                    "Client": $("#client").val(),
                                })
                            };
                            var a = $("#url0").val();

                            $("#url1").val(a + '/api/Bridge?json=' + JSON.stringify(inp))

                            if (inp.func == "get1") {
                                $.ajax({
                                    async: false,
                                    type: "GET",
                                    url: a + '/api/Bridge',
                                    data: { "json": JSON.stringify(inp) },
                                    dataType: 'jsonp',
                                    success: function (response) {
                                        $("#res").val(response);
                                    },
                                    error: function (response) {
                                        alert("error");
                                    }
                                });
                            }
                            else {
                                $.ajax({
                                    async: false,
                                    type: "GET",
                                    url: a + '/api/Bridge',
                                    data: { "json": JSON.stringify(inp) },
                                    dataType: 'jsonp',
                                    success: function (response) {
                                        $("#res").val(response);
                                    },
                                    error: function (response) {
                                        alert("error");
                                    }
                                });
                            }

                            setTimeout(function ()
                            {
                                refresh();
                            }, 1);
                          
                            function sel(param) {
                                if (param.trim() == "Create") { return "post1"; }
                                if (param.trim() == "Read") { return "get1"; }
                                if (param.trim() == "Update") { return "post2"; }
                                if (param.trim() == "Delete") { return "post3"; }
                                if (param.trim() == "Delete All") { return "post4"; }
                            }
                        }
                        function start() {
                            $("#ref").attr("start", "true");
                            $("#str").css("display", "none");
                            $("#ref").css("display", "block");
                            $("#stp").css("display", "block");
                        }
                        function stop() {
                            $("#ref").attr("start", "false");
                            $("#str").css("display", "block");
                            $("#ref").css("display", "none");
                            $("#stp").css("display", "none");
                        }
                        function refresh() {
                            start();

                            var a = $("#url0").val();
                            var inp = {
                                "control": $("#control").val() + 'Controller',
                                "func": "log",
                                "param": JSON.stringify({
                                    "Idx": "",
                                    "FName": "",
                                    "LName": "",
                                    "Client": $("#client").val(),
                                })
                            };
                            $.ajax({
                                async: false,
                                type: "GET",
                                url: a + '/api/Bridge',
                                data: { "json": JSON.stringify(inp) },
                                dataType: 'jsonp',
                                success: function (response)
                                {
                                    var str = "";
                                    var ob = $("#lg0").first().clone();
                                    ob.removeClass("lgh");
                                    ob.addClass("lgs");

                                    var json = $.parseJSON(response); 
                                    $(json).each(function (i, val)
                                    { 
                                        var a = $("<div/>").html(ob).children().first();
                                        a.find(".lgc1").html(val.client);
                                        a.find(".lgc2").html(val.exception);
                                        a.find(".lgc3").html(val.datetime);

                                        str += $("<div/>").html(a).html(); 
                                    }); 
                                    $("#log").html(str);
                                },
                                error: function (response) {
                                    alert("error");
                                }
                            });
                        }
                        $(window).on("load", function () {

                            alert($(window).outerWidth());

                            setInterval(function () {
                                if ($("#ref").attr("start") == "true") {
                                    refresh();
                                }
                            }, 10000);

                        })
                    </script>
                </div>
            </div>
        </div>
    </main>

    <ul id="Customer"></ul>
    <div id="root"></div>
</body>
</html>
 

